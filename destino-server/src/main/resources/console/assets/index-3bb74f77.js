import{u as H,_ as L}from"./refresh-322ce6d8.js";import{d as V,ag as B,aJ as x,r as m,ah as a,aj as d,o as O,ab as A,ac as E,ai as i,ak as s,_ as z,ae as k,al as G,ar as I,bs as J,aW as M}from"./index-e6583b55.js";import{i as Q}from"./registration-bdac1359.js";import{u as q,_ as F}from"./use-table-height-e0ae8eb8.js";import{_ as K}from"./namespace-tabs.vue_vue_type_script_setup_true_lang-5bdf7d6b.js";import{N as X}from"./GradientText-5b840e5a.js";import{a as N}from"./Select-33cfb7e8.js";import{_ as C}from"./Space-83e95913.js";import{_ as Y}from"./Input-d290ecc1.js";import{_ as Z,a as ee}from"./FormItem-922e3fb1.js";import"./Checkbox-9e61f810.js";import"./Dropdown-9a22fc8f.js";const ae={class:"h-full overflow-hidden"};function te(c){return typeof c=="function"||Object.prototype.toString.call(c)==="[object Object]"&&!J(c)}const de=V({__name:"index",setup(c){const{t:o}=B(),{loading:g,startLoading:S,endLoading:T}=H(!1),{tableHeight:j,initTableHeight:W}=q(),n=x({namespace:"",groupName:"",serviceName:"",page:0,size:10}),b=m(),_=m(),v=m([]),D=m([{key:"ip",title:()=>o("message.subscriber.address"),minWidth:200,resizable:!0,ellipsis:{tooltip:!0},render:e=>a(X,null,{default:()=>[e.ip,d(":"),e.port]})},{key:"version",title:()=>o("message.subscriber.info"),minWidth:200,resizable:!0,ellipsis:{tooltip:!0},render:e=>{const t=[];return e.platform&&t.push(a(N,{type:"success"},{default:()=>[e.platform]})),e.version&&t.push(a(N,null,{default:()=>[e.version]})),a(C,null,te(t)?t:{default:()=>[t]})}},{key:"types",title:()=>o("message.subscriber.type"),align:"center",resizable:!0,minWidth:150,ellipsis:{tooltip:!0},render:e=>e.types?e.types.join(" / "):""},{key:"subscribeServiceCount",title:()=>o("message.subscriber.serviceCount"),align:"center",resizable:!0,minWidth:50}]),l=x({page:1,pageSize:n.size,showSizePicker:!0,pageSizes:[10,15,20,25,30],onChange:e=>{l.page=e,n.page=e-1,p()},onUpdatePageSize:e=>{n.size!==e&&(n.size=e,l.pageSize=e,n.page=0,l.page=1,p())}});O(()=>{W(b),h()});function h(){_.value.load().then(()=>{p()})}async function p(e=!1){S(),e&&(n.page=0,l.page=1);const t=await _.value.selected();n.namespace=t.name;const{data:r}=await Q(n);r?(y(r.records),P(r)):y([]),T()}function y(e){v.value=e}function P(e){l.itemCount=e.total}return(e,t)=>{const r=Y,f=Z,R=ee,U=L,$=F,w=M;return A(),E("div",ae,[a(w,{bordered:!1,class:"rounded-8px shadow-sm"},{default:i(()=>[a(K,{ref_key:"namespaceRef",ref:_,"onUpdate:activated":t[0]||(t[0]=u=>p(!1))},null,512),a(s(C),{class:"pb-12px",justify:"space-between"},{default:i(()=>[a(R,{inline:"","label-placement":"left","show-feedback":!1,size:"small"},{default:i(()=>[a(f,{label:s(o)("message.service.groupName")},{default:i(()=>[a(r,{value:n.groupName,"onUpdate:value":t[1]||(t[1]=u=>n.groupName=u),maxlength:"300",placeholder:""},null,8,["value"])]),_:1},8,["label"]),a(f,{label:s(o)("message.service.name")},{default:i(()=>[a(r,{value:n.serviceName,"onUpdate:value":t[2]||(t[2]=u=>n.serviceName=u),maxlength:"300",placeholder:""},null,8,["value"])]),_:1},8,["label"]),a(f,null,{default:i(()=>[a(s(z),{type:"primary",ghost:"",onClick:t[3]||(t[3]=u=>p(!0))},{default:i(()=>[d(k(s(o)("message.operation.search")),1)]),_:1})]),_:1})]),_:1}),a(s(z),{size:"small",type:"primary",onClick:h},{default:i(()=>[a(U,{class:G(["mr-4px text-16px",{"animate-spin":s(g)}])},null,8,["class"]),d(" "+k(s(o)("message.table.refresh")),1)]),_:1})]),_:1}),a($,{ref_key:"tableRef",ref:b,columns:D.value,data:v.value,loading:s(g),pagination:l,style:I({height:`${s(j)}px`}),"flex-height":"",remote:""},null,8,["columns","data","loading","pagination","style"])]),_:1})])}}});export{de as default};
